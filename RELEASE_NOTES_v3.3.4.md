# Recording King v3.3.4 发布说明

## 🔧 重要修复

### 权限系统优化
- **修复辅助功能权限检测错误** - 解决权限诊断中总是显示❌的问题
- **修复输入监控权限检测** - 修复全局快捷键权限检测逻辑
- **统一权限接口** - 解决前后端参数名不匹配导致的权限检测失败
- **增强安全性** - 添加输入验证白名单，防止潜在的安全风险

### 具体改进
1. **前后端一致性**
   - 统一使用 `permission_type` 参数名
   - 修复布尔值与字符串类型不匹配问题

2. **权限检测准确性**
   - 改进 macOS 输入监控权限的 IOHIDCheckAccess 检测逻辑
   - 修复权限名称不一致问题 (`input_monitoring` → `input-monitoring`)

3. **安全性提升**
   - 所有权限相关函数添加输入验证
   - 防止命令注入攻击

## 🎯 用户体验改善

- **快捷键界面** - 权限诊断现在能正确显示权限状态
- **更可靠的权限检查** - 减少误报和权限检测错误
- **更清晰的权限提示** - 用户能准确了解当前权限状态

## 📋 技术细节

### 修改的文件
- `src-tauri/src/commands/permissions.rs` - 权限检测后端逻辑
- `src/components/DiagnosticSteps.tsx` - 权限诊断前端界面

### 兼容性
- ✅ macOS 10.15+
- ✅ 现有用户数据完全兼容
- ✅ 所有现有功能保持不变

## 🚀 升级建议

建议所有用户升级到此版本以获得更稳定的权限检测体验，特别是依赖全局快捷键功能的用户。

---

**发布日期**: 2025-08-15  
**构建类型**: 生产版本  
**平台支持**: macOS (Apple Silicon & Intel)