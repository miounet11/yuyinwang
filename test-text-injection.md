# 文本注入功能测试指南

## 测试步骤

1. **打开Recording King应用**
   - 应用已经在运行中

2. **打开另一个文本编辑器**
   - 可以使用TextEdit、VS Code、Notes等任何带有文本输入框的应用
   - 确保该应用的窗口已经打开并准备好接收文本

3. **切换回Recording King**
   - 点击Recording King窗口使其获得焦点
   - 这时系统会记录你之前使用的文本编辑器

4. **测试录音和文本注入**
   - 在Recording King中点击"开始录音"按钮
   - 说一些内容（比如"测试文本注入功能"）
   - 点击"停止录音"
   - 系统会自动将转录的文本注入到之前的文本编辑器中

## 配置要求

在历史记录页面，点击"文本注入"按钮，确保以下设置：
- ✅ 启用自动注入
- 注入延迟：100ms（默认）
- 使用剪贴板方式（推荐）

## 工作原理

1. 当Recording King失去焦点时，系统会记录新的活动应用（通过`track_previous_app`）
2. 转录完成后，系统会通过`smart_inject_text_with_app_switch`命令：
   - 激活之前记录的应用
   - 将转录文本注入到该应用中
   - 避免注入到Recording King自身

## 故障排除

如果文本注入不工作：
1. 检查权限：确保已授予辅助功能权限
2. 检查控制台日志：查看是否有错误信息
3. 确保目标应用有可输入的文本框
4. 尝试增加注入延迟时间

## 注意事项

- 系统会自动过滤掉Recording King自身，避免死循环
- 如果没有记录到前一个应用，文本会注入到当前活动的应用
- 某些应用可能需要特殊权限才能接收文本注入